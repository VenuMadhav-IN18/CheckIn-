<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Super Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div id="messageBox" class="alert d-none" role="alert"></div>
<div class="container mt-4">
  <h2 class="mb-4">Super Admin Dashboard</h2>
  <div class="card mb-4">
    <div class="card-header">Admin Management</div>
    <div class="card-body">
      <form id="addAdminForm" class="mb-3">
        <input type="text" class="form-control mb-2" id="adminName" placeholder="Admin Name" required>
        <input type="email" class="form-control mb-2" id="adminEmail" placeholder="Admin Email" required>
        <input type="password" class="form-control mb-2" id="adminPass" placeholder="Password" required>
        <button type="submit" class="btn btn-primary" >Add Admin</button>
      </form>
      <button class="btn btn-secondary" onclick="fetchAdmins()">View Admins</button>
      <ul id="adminsList" class="list-group mt-3"></ul>
    </div>
  </div>
  <div class="card mb-4">
    <div class="card-header">Site Management</div>
    <div class="card-body">
      <form id="addSiteForm" class="mb-3">
        <input type="text" class="form-control mb-2" id="siteName" placeholder="Site Name" required>
        <input type="text" class="form-control mb-2" id="siteLocation" placeholder="Location">
        <button type="submit" class="btn btn-success">Add Site</button>
      </form>
    </div>
  </div>
  <div class="card mb-4">
    <div class="card-header">Global Attendance</div>
    <div class="card-body">
      <input type="date" id="attendanceDate">
      <button class="btn btn-info" onclick="fetchAttendance()">Get Attendance</button>
      <table class="table mt-3">
        <thead><tr><th>Name</th><th>Role</th><th>Site</th><th>Check-in</th><th>Check-out</th><th>Status</th></tr></thead>
        <tbody id="attendanceTable"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
  // Handle Add Admin form submission
  const form = document.getElementById('addAdminForm');
  form.addEventListener('submit', async function (e) {
    e.preventDefault();

    const adminName = document.getElementById('adminName').value.trim();
    
    const adminPass = document.getElementById('adminPass').value.trim();

    fetch('/register', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ adminName, adminPass })
    })
    .then(res => res.json())
    .then(data => {
    if (data.message) {
      showMessage(data.message, 'success');
      form.reset(); // optional: clear form
    } else if (data.error) {
        showMessage(data.error, 'danger');
    } else {
        showMessage('Unexpected response', 'warning');
    }
  })
  .catch(err => showMessage('⚠️ Request failed: ' + err.message, 'danger'));

function showMessage(text, type = 'success') {
  const box = document.getElementById('messageBox');
  // Clear previous classes
  box.className = `alert alert-${type} mt-2`;
  box.textContent = text;
  // Show message
  box.classList.remove('d-none');
  // Hide after a few seconds
  setTimeout(() => {
    box.classList.add('d-none');
  }, 4000);
}
});
</script>
</body>
</html>
