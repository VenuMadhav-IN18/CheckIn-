<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    
<div class="container d-flex justify-content-center align-items-center" style="height:100vh;">
    
<div class="col-12 col-sm-8 col-md-6 col-lg-6">
<h3 class="text-center mb-4 fw-bold">Add Worker</h3>

<div class="border border-dark p-4 rounded shadow bg-light w-200">
    <h5 class="text-center mb-4 fw-bold">Fill the Details</h5>
    <form class="row g-3" id="addWorker">
    <div class="col-md-4">
        <label for="validationDefault01"  class="form-label">Name of Worker</label>
        <input type="text" class="form-control" id="name" placeholder="Enter Name of Worker" value="Mark" required>
    </div>
    <div class="col-md-4">
        <label for="employee_code" class="form-label">Employee Code</label>
        <input type="text" class="form-control" id="employee_code" name="employee_code" placeholder="Enter Code" required>
    </div>

    <div class="mb-3">
        <label for="inputMobile"  class="form-label">Mobile Number</label>
        <input type="tel" class="form-control" id="mobileNumber" 
            placeholder="Enter your mobile number" 
            pattern="[0-9]{10}" maxlength="10">
    </div>
    <div class="col-md-6">
        <label for="validationDefault03"  class="form-label">Site/Location</label>
        <input type="text" class="form-control" id="site" required>
    </div>
    <div class="col-md-3">
        <label for="validationDefault04" class="form-label">Role</label>
        <select class="form-select" id="role" required>
            <option selected disabled value="">Choose...</option>
            <option>Worker</option>
            <option>Admin</option>
        </select>
    </div>
    <div class="col-md-6">
        <label for="workerPin" class="form-label">Assign PIN</label>
        <input type="number" class="form-control" id="pin" name="workerPin"required min="1000" 
           max="9999"placeholder="4-digit PIN">
    </div>
    <div class="col-12">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="invalidCheck2" required>
            <label class="form-check-label" for="invalidCheck2">
                Agree to terms and conditions
            </label>
        </div>
    </div>
    <div class="col-12">
        <button class="btn btn-primary" type="submit">Submit form</button>
    </div>
    </form>
    </div>
</div>
</div>
<script>
    // addworker.js
document.getElementById("addWorker").addEventListener("submit", async (e) => {
  e.preventDefault(); // stop default reload

  const formData = {
    name: document.getElementById("name").value,
    employee_code: document.getElementById("employee_code").value,
    mobile: document.getElementById("mobileNumber").value,
    site: document.getElementById("site").value,
    role: document.getElementById("role").value,
    pin: document.getElementById("pin").value,
  };

  try {
    const res = await fetch("http://localhost:3000/add-worker", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(formData),
    });

    if (res.ok) {
      alert("✅ Worker added successfully!");
      window.location.href = "AdminDashboard.html"; // redirect back
    } else {
      alert("❌ Failed to add worker.");
    }
  } catch (error) {
    console.error("Error:", error);
    alert("⚠️ Something went wrong.");
  }
});

</script>
</body>
</html>